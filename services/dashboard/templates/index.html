<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Refresherr Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
</head>
<body>
<main class="container">
  <h1>Refresherr Dashboard</h1>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <article>
        {% for category, message in messages %}
          <p><strong>{{ category|upper }}</strong> â€” {{ message }}</p>
        {% endfor %}
      </article>
    {% endif %}
  {% endwith %}

  <section class="grid">
    <article>
      <h3>Movies (symlinked)</h3>
      <p><strong>{{ movies_linked }}</strong> / {{ movies_total }} ({{ '%.2f'|format(mov_pct) }}%)</p>
      <a href="{{ url_for('movies') }}" role="button">Browse Movies</a>
    </article>
    <article>
      <h3>Episodes (symlinked)</h3>
      <p><strong>{{ eps_linked }}</strong> / {{ eps_total }} ({{ '%.2f'|format(eps_pct) }}%)</p>
      <a href="{{ url_for('episodes') }}" role="button">Browse Episodes</a>
    </article>
    <article>
      <h3>Broken symlinks</h3>
      <p><strong>{{ broken }}</strong></p>
      <a href="{{ url_for('broken') }}" role="button" class="secondary">View Broken</a>
    </article>
  </section>

  {% if not relay_ok %}
    <p><small>Note: Relay not configured for actions (set RELAY_BASE and RELAY_TOKEN in env).</small></p>
  {% endif %}
</main>
</body>
</html>
